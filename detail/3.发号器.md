# 发号器

发号器的机制也需要讲一讲。

一般情况下，在系统启动之后，发号器应当加载已用号段。

单生成器发请求过来之后，发号器会根据规则生成一个号段然后返回。

这个规则可能包含生成那张表内的号段、有多少个号码。

发号器的日志是必不可少的，如果出现了不可预估的错误，没日志可真不好查。

发号器的机制其实很简单的，实现起来也很简单。

```golang

func load() {
	// 加载已用号段
	// 加载规则
}

func Listen() {
	// 等待请求，返回生成的数据
	rerutn generate()
}

func generate() {
	// 根据规则生成号段
}

```

还有一点需要提一下，加载已用号段是需要检查数据库的，因为号段并不是放下去之后就一定会被用完的。

比如，某个生成器的主机断电了，那么就肯定会有很多号码没使用。








